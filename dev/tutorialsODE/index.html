<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Neural mass equation (Hopf aBS) · Bifurcation Analysis in Julia</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Bifurcation Analysis in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bifurcation Analysis in Julia</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../guidelines/">Overview</a></li><li><a class="tocitem" href="../tutorials/">Tutorials</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Functionalities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><a class="tocitem" href="../Predictors/">Predictors / correctors</a></li><li><a class="tocitem" href="../EventCallback/">Event Handling and Callback</a></li><li><a class="tocitem" href="../detectionBifurcation/">Bifurcation detection (codim 1)</a></li><li><a class="tocitem" href="../codim2Continuation/">Fold / Hopf Continuation (codim 2)</a></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Normal form</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../simplebp/">Simple branch point</a></li><li><a class="tocitem" href="../nonsimplebp/">Non-simple branch point</a></li><li><a class="tocitem" href="../simplehopf/">Simple Hopf point</a></li></ul></li><li><a class="tocitem" href="../branchswitching/">Branch switching</a></li><li><a class="tocitem" href="../BifurcationDiagram/">Bifurcation diagram</a></li><li><a class="tocitem" href="../DeflatedContinuation/">Deflated Continuation</a></li><li><a class="tocitem" href="../deflatedproblem/">Deflated problems</a></li><li><a class="tocitem" href="../constrainedproblem/">Constrained problem</a></li><li><input class="collapse-toggle" id="menuitem-4-12" type="checkbox"/><label class="tocitem" for="menuitem-4-12"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../periodicOrbit/">Introduction</a></li><li><a class="tocitem" href="../periodicOrbitTrapeze/">Finite Differences</a></li><li><a class="tocitem" href="../periodicOrbitShooting/">Shooting</a></li></ul></li><li><a class="tocitem" href="../diffeq/">DiffEq wrapper</a></li><li><a class="tocitem" href="../iterator/">Iterator Interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Options</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../linearsolver/">Linear Solvers</a></li><li><a class="tocitem" href="../borderedlinearsolver/">Bordered linear solvers</a></li><li><a class="tocitem" href="../eigensolver/">Eigen Solvers</a></li><li><a class="tocitem" href="../Borderedarrays/">Bordered arrays</a></li></ul></li><li><a class="tocitem" href="../faq/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Neural mass equation (Hopf aBS)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Neural mass equation (Hopf aBS)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rveltz/BifurcationKit.jl/blob/master/docs/src/tutorialsODE.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Neural-mass-equation-(Hopf-aBS)"><a class="docs-heading-anchor" href="#Neural-mass-equation-(Hopf-aBS)">Neural mass equation (Hopf aBS)</a><a id="Neural-mass-equation-(Hopf-aBS)-1"></a><a class="docs-heading-anchor-permalink" href="#Neural-mass-equation-(Hopf-aBS)" title="Permalink"></a></h1><ul><li><a href="#Neural-mass-equation-(Hopf-aBS)">Neural mass equation (Hopf aBS)</a></li><ul><li><a href="#Branch-of-periodic-orbits-with-finite-differences">Branch of periodic orbits with finite differences</a></li><li><a href="#Periodic-orbits-with-Parallel-Standard-Shooting">Periodic orbits with Parallel Standard Shooting</a></li><li><a href="#References">References</a></li></ul></ul><p>The following model is taken from <sup class="footnote-reference"><a id="citeref-Cortes" href="#footnote-Cortes">[Cortes]</a></sup>:</p><p class="math-container">\[\left\{\begin{array}{l}
\tau \dot{E}=-E+g\left(J u x E+E_{0}\right) \\
\dot{x}=\tau_{D}^{-1}(1-x)-u E x \\
\dot{u}=U E(1-u)-\tau_{F}^{-1}(u-U)
\end{array}\right.\]</p><p>The model is interesting because the branch of periodic solutions converges to an homoclinic orbit which is challenging to compute with our methods. We provide three different ways to compute this periodic orbits and highlight their pro / cons.</p><p>It is easy to encode the ODE as follows</p><pre><code class="language-julia hljs">using Revise, ForwardDiff, Parameters, Setfield, Plots, LinearAlgebra
using BifurcationKit
const BK = BifurcationKit

# sup norm
norminf = x -&gt; norm(x, Inf)

# vector field
function TMvf!(dz, z, p, t)
	@unpack J, α, E0, τ, τD, τF, U0 = p
	E, x, u = z
	SS0 = J * u * x * E + E0
	SS1 = α * log(1 + exp(SS0 / α))
	dz[1] = (-E + SS1) / τ
	dz[2] =	(1.0 - x) / τD - u * x * E
	dz[3] = (U0 - u) / τF +  U0 * (1.0 - u) * E
	dz
end

# out of place method
TMvf(z, p) = TMvf!(similar(z), z, p, 0)

# we group the differentials together
dTMvf = (z,p) -&gt; ForwardDiff.jacobian(x -&gt; TMvf(x,p), z)
jet = BK.getJet(TMvf, dTMvf)

# parameter values
par_tm = (α = 1.5, τ = 0.013, J = 3.07, E0 = -2.0, τD = 0.200, U0 = 0.3, τF = 1.5, τS = 0.007)

# initial condition
z0 = [0.238616, 0.982747, 0.367876 ]</code></pre><p>We first compute the branch of equilibria</p><pre><code class="language-julia hljs"># continuation options
opts_br = ContinuationPar(pMin = -10.0, pMax = -0.9,
	# parameters to have a smooth result
	ds = 0.04, dsmax = 0.05,
		# this is to detect bifurcation points precisely
		detectBifurcation = 3,
	# Optional: bisection options for locating bifurcations
	nInversion = 8, maxBisectionSteps = 25, nev = 3)

# continuation of equilibria
br, = continuation(TMvf, dTMvf, z0, par_tm, (@lens _.E0), opts_br;
	recordFromSolution = (x, p) -&gt; (E = x[1], x = x[2], u = x[3]),
	tangentAlgo = BorderedPred(),
	plot = true, verbosity = 0, normC = norminf)

scene = plot(br, plotfold=false, markersize=3, legend=:topleft)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip050">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip050)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip051">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip050)" d="
M175.445 1423.18 L2352.76 1423.18 L2352.76 47.2441 L175.445 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip052">
    <rect x="175" y="47" width="2178" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  237.067,1423.18 237.067,47.2441 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  703.901,1423.18 703.901,47.2441 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1170.73,1423.18 1170.73,47.2441 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1637.57,1423.18 1637.57,47.2441 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2104.4,1423.18 2104.4,47.2441 
  "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.445,1423.18 2352.76,1423.18 
  "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  237.067,1423.18 237.067,1406.67 
  "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  703.901,1423.18 703.901,1406.67 
  "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1170.73,1423.18 1170.73,1406.67 
  "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1637.57,1423.18 1637.57,1406.67 
  "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2104.4,1423.18 2104.4,1406.67 
  "/>
<path clip-path="url(#clip050)" d="M168.514 1467.02 L198.19 1467.02 L198.19 1470.96 L168.514 1470.96 L168.514 1467.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M212.31 1479.92 L228.63 1479.92 L228.63 1483.85 L206.685 1483.85 L206.685 1479.92 Q209.347 1477.16 213.931 1472.53 Q218.537 1467.88 219.718 1466.54 Q221.963 1464.01 222.843 1462.28 Q223.746 1460.52 223.746 1458.83 Q223.746 1456.07 221.801 1454.34 Q219.88 1452.6 216.778 1452.6 Q214.579 1452.6 212.125 1453.37 Q209.695 1454.13 206.917 1455.68 L206.917 1450.96 Q209.741 1449.82 212.195 1449.25 Q214.648 1448.67 216.685 1448.67 Q222.056 1448.67 225.25 1451.35 Q228.445 1454.04 228.445 1458.53 Q228.445 1460.66 227.634 1462.58 Q226.847 1464.48 224.741 1467.07 Q224.162 1467.74 221.06 1470.96 Q217.959 1474.15 212.31 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M238.445 1477.97 L243.329 1477.97 L243.329 1483.85 L238.445 1483.85 L238.445 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M263.514 1452.37 Q259.903 1452.37 258.074 1455.94 Q256.268 1459.48 256.268 1466.61 Q256.268 1473.71 258.074 1477.28 Q259.903 1480.82 263.514 1480.82 Q267.148 1480.82 268.954 1477.28 Q270.782 1473.71 270.782 1466.61 Q270.782 1459.48 268.954 1455.94 Q267.148 1452.37 263.514 1452.37 M263.514 1448.67 Q269.324 1448.67 272.38 1453.27 Q275.458 1457.86 275.458 1466.61 Q275.458 1475.33 272.38 1479.94 Q269.324 1484.52 263.514 1484.52 Q257.704 1484.52 254.625 1479.94 Q251.569 1475.33 251.569 1466.61 Q251.569 1457.86 254.625 1453.27 Q257.704 1448.67 263.514 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M293.676 1452.37 Q290.065 1452.37 288.236 1455.94 Q286.43 1459.48 286.43 1466.61 Q286.43 1473.71 288.236 1477.28 Q290.065 1480.82 293.676 1480.82 Q297.31 1480.82 299.115 1477.28 Q300.944 1473.71 300.944 1466.61 Q300.944 1459.48 299.115 1455.94 Q297.31 1452.37 293.676 1452.37 M293.676 1448.67 Q299.486 1448.67 302.541 1453.27 Q305.62 1457.86 305.62 1466.61 Q305.62 1475.33 302.541 1479.94 Q299.486 1484.52 293.676 1484.52 Q287.866 1484.52 284.787 1479.94 Q281.731 1475.33 281.731 1466.61 Q281.731 1457.86 284.787 1453.27 Q287.866 1448.67 293.676 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M635.845 1467.02 L665.521 1467.02 L665.521 1470.96 L635.845 1470.96 L635.845 1467.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M676.424 1479.92 L684.063 1479.92 L684.063 1453.55 L675.753 1455.22 L675.753 1450.96 L684.016 1449.29 L688.692 1449.29 L688.692 1479.92 L696.331 1479.92 L696.331 1483.85 L676.424 1483.85 L676.424 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M705.776 1477.97 L710.66 1477.97 L710.66 1483.85 L705.776 1483.85 L705.776 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M719.664 1449.29 L741.886 1449.29 L741.886 1451.28 L729.34 1483.85 L724.456 1483.85 L736.261 1453.23 L719.664 1453.23 L719.664 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M751.053 1449.29 L769.409 1449.29 L769.409 1453.23 L755.335 1453.23 L755.335 1461.7 Q756.354 1461.35 757.372 1461.19 Q758.391 1461 759.41 1461 Q765.197 1461 768.576 1464.18 Q771.956 1467.35 771.956 1472.76 Q771.956 1478.34 768.484 1481.44 Q765.011 1484.52 758.692 1484.52 Q756.516 1484.52 754.248 1484.15 Q752.002 1483.78 749.595 1483.04 L749.595 1478.34 Q751.678 1479.48 753.9 1480.03 Q756.122 1480.59 758.599 1480.59 Q762.604 1480.59 764.942 1478.48 Q767.28 1476.38 767.28 1472.76 Q767.28 1469.15 764.942 1467.05 Q762.604 1464.94 758.599 1464.94 Q756.724 1464.94 754.849 1465.36 Q752.998 1465.77 751.053 1466.65 L751.053 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1102.18 1467.02 L1131.86 1467.02 L1131.86 1470.96 L1102.18 1470.96 L1102.18 1467.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1142.76 1479.92 L1150.4 1479.92 L1150.4 1453.55 L1142.09 1455.22 L1142.09 1450.96 L1150.35 1449.29 L1155.03 1449.29 L1155.03 1479.92 L1162.67 1479.92 L1162.67 1483.85 L1142.76 1483.85 L1142.76 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1172.11 1477.97 L1177 1477.97 L1177 1483.85 L1172.11 1483.85 L1172.11 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1187.23 1449.29 L1205.58 1449.29 L1205.58 1453.23 L1191.51 1453.23 L1191.51 1461.7 Q1192.53 1461.35 1193.55 1461.19 Q1194.56 1461 1195.58 1461 Q1201.37 1461 1204.75 1464.18 Q1208.13 1467.35 1208.13 1472.76 Q1208.13 1478.34 1204.66 1481.44 Q1201.19 1484.52 1194.87 1484.52 Q1192.69 1484.52 1190.42 1484.15 Q1188.18 1483.78 1185.77 1483.04 L1185.77 1478.34 Q1187.85 1479.48 1190.07 1480.03 Q1192.3 1480.59 1194.77 1480.59 Q1198.78 1480.59 1201.12 1478.48 Q1203.45 1476.38 1203.45 1472.76 Q1203.45 1469.15 1201.12 1467.05 Q1198.78 1464.94 1194.77 1464.94 Q1192.9 1464.94 1191.02 1465.36 Q1189.17 1465.77 1187.23 1466.65 L1187.23 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1227.34 1452.37 Q1223.73 1452.37 1221.9 1455.94 Q1220.1 1459.48 1220.1 1466.61 Q1220.1 1473.71 1221.9 1477.28 Q1223.73 1480.82 1227.34 1480.82 Q1230.98 1480.82 1232.78 1477.28 Q1234.61 1473.71 1234.61 1466.61 Q1234.61 1459.48 1232.78 1455.94 Q1230.98 1452.37 1227.34 1452.37 M1227.34 1448.67 Q1233.15 1448.67 1236.21 1453.27 Q1239.29 1457.86 1239.29 1466.61 Q1239.29 1475.33 1236.21 1479.94 Q1233.15 1484.52 1227.34 1484.52 Q1221.53 1484.52 1218.45 1479.94 Q1215.4 1475.33 1215.4 1466.61 Q1215.4 1457.86 1218.45 1453.27 Q1221.53 1448.67 1227.34 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1569.51 1467.02 L1599.19 1467.02 L1599.19 1470.96 L1569.51 1470.96 L1569.51 1467.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1610.09 1479.92 L1617.73 1479.92 L1617.73 1453.55 L1609.42 1455.22 L1609.42 1450.96 L1617.68 1449.29 L1622.36 1449.29 L1622.36 1479.92 L1630 1479.92 L1630 1483.85 L1610.09 1483.85 L1610.09 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1639.44 1477.97 L1644.33 1477.97 L1644.33 1483.85 L1639.44 1483.85 L1639.44 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1658.54 1479.92 L1674.86 1479.92 L1674.86 1483.85 L1652.91 1483.85 L1652.91 1479.92 Q1655.58 1477.16 1660.16 1472.53 Q1664.77 1467.88 1665.95 1466.54 Q1668.19 1464.01 1669.07 1462.28 Q1669.97 1460.52 1669.97 1458.83 Q1669.97 1456.07 1668.03 1454.34 Q1666.11 1452.6 1663.01 1452.6 Q1660.81 1452.6 1658.35 1453.37 Q1655.92 1454.13 1653.15 1455.68 L1653.15 1450.96 Q1655.97 1449.82 1658.42 1449.25 Q1660.88 1448.67 1662.91 1448.67 Q1668.28 1448.67 1671.48 1451.35 Q1674.67 1454.04 1674.67 1458.53 Q1674.67 1460.66 1673.86 1462.58 Q1673.08 1464.48 1670.97 1467.07 Q1670.39 1467.74 1667.29 1470.96 Q1664.19 1474.15 1658.54 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1684.72 1449.29 L1703.08 1449.29 L1703.08 1453.23 L1689 1453.23 L1689 1461.7 Q1690.02 1461.35 1691.04 1461.19 Q1692.06 1461 1693.08 1461 Q1698.86 1461 1702.24 1464.18 Q1705.62 1467.35 1705.62 1472.76 Q1705.62 1478.34 1702.15 1481.44 Q1698.68 1484.52 1692.36 1484.52 Q1690.18 1484.52 1687.91 1484.15 Q1685.67 1483.78 1683.26 1483.04 L1683.26 1478.34 Q1685.34 1479.48 1687.57 1480.03 Q1689.79 1480.59 1692.27 1480.59 Q1696.27 1480.59 1698.61 1478.48 Q1700.95 1476.38 1700.95 1472.76 Q1700.95 1469.15 1698.61 1467.05 Q1696.27 1464.94 1692.27 1464.94 Q1690.39 1464.94 1688.52 1465.36 Q1686.66 1465.77 1684.72 1466.65 L1684.72 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M2035.85 1467.02 L2065.52 1467.02 L2065.52 1470.96 L2035.85 1470.96 L2035.85 1467.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M2076.43 1479.92 L2084.07 1479.92 L2084.07 1453.55 L2075.75 1455.22 L2075.75 1450.96 L2084.02 1449.29 L2088.69 1449.29 L2088.69 1479.92 L2096.33 1479.92 L2096.33 1483.85 L2076.43 1483.85 L2076.43 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M2105.78 1477.97 L2110.66 1477.97 L2110.66 1483.85 L2105.78 1483.85 L2105.78 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M2130.85 1452.37 Q2127.24 1452.37 2125.41 1455.94 Q2123.6 1459.48 2123.6 1466.61 Q2123.6 1473.71 2125.41 1477.28 Q2127.24 1480.82 2130.85 1480.82 Q2134.48 1480.82 2136.29 1477.28 Q2138.12 1473.71 2138.12 1466.61 Q2138.12 1459.48 2136.29 1455.94 Q2134.48 1452.37 2130.85 1452.37 M2130.85 1448.67 Q2136.66 1448.67 2139.71 1453.27 Q2142.79 1457.86 2142.79 1466.61 Q2142.79 1475.33 2139.71 1479.94 Q2136.66 1484.52 2130.85 1484.52 Q2125.04 1484.52 2121.96 1479.94 Q2118.9 1475.33 2118.9 1466.61 Q2118.9 1457.86 2121.96 1453.27 Q2125.04 1448.67 2130.85 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M2161.01 1452.37 Q2157.4 1452.37 2155.57 1455.94 Q2153.76 1459.48 2153.76 1466.61 Q2153.76 1473.71 2155.57 1477.28 Q2157.4 1480.82 2161.01 1480.82 Q2164.64 1480.82 2166.45 1477.28 Q2168.28 1473.71 2168.28 1466.61 Q2168.28 1459.48 2166.45 1455.94 Q2164.64 1452.37 2161.01 1452.37 M2161.01 1448.67 Q2166.82 1448.67 2169.87 1453.27 Q2172.95 1457.86 2172.95 1466.61 Q2172.95 1475.33 2169.87 1479.94 Q2166.82 1484.52 2161.01 1484.52 Q2155.2 1484.52 2152.12 1479.94 Q2149.06 1475.33 2149.06 1466.61 Q2149.06 1457.86 2152.12 1453.27 Q2155.2 1448.67 2161.01 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1228.13 1520.52 L1258.18 1520.52 L1258.18 1525.93 L1234.56 1525.93 L1234.56 1540 L1257.19 1540 L1257.19 1545.41 L1234.56 1545.41 L1234.56 1562.63 L1258.75 1562.63 L1258.75 1568.04 L1228.13 1568.04 L1228.13 1520.52 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1283.64 1524.76 Q1278.68 1524.76 1276.16 1529.66 Q1273.68 1534.53 1273.68 1544.33 Q1273.68 1554.1 1276.16 1559 Q1278.68 1563.87 1283.64 1563.87 Q1288.64 1563.87 1291.12 1559 Q1293.64 1554.1 1293.64 1544.33 Q1293.64 1534.53 1291.12 1529.66 Q1288.64 1524.76 1283.64 1524.76 M1283.64 1519.66 Q1291.63 1519.66 1295.83 1526 Q1300.07 1532.3 1300.07 1544.33 Q1300.07 1556.33 1295.83 1562.66 Q1291.63 1568.97 1283.64 1568.97 Q1275.65 1568.97 1271.42 1562.66 Q1267.22 1556.33 1267.22 1544.33 Q1267.22 1532.3 1271.42 1526 Q1275.65 1519.66 1283.64 1519.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  175.445,1121.89 2352.76,1121.89 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  175.445,769.515 2352.76,769.515 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  175.445,417.14 2352.76,417.14 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  175.445,64.7642 2352.76,64.7642 
  "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.445,1423.18 175.445,47.2441 
  "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.445,1121.89 201.573,1121.89 
  "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.445,769.515 201.573,769.515 
  "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.445,417.14 201.573,417.14 
  "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.445,64.7642 201.573,64.7642 
  "/>
<path clip-path="url(#clip050)" d="M123.126 1135.24 L139.445 1135.24 L139.445 1139.17 L117.501 1139.17 L117.501 1135.24 Q120.163 1132.48 124.746 1127.85 Q129.353 1123.2 130.533 1121.86 Q132.779 1119.33 133.658 1117.6 Q134.561 1115.84 134.561 1114.15 Q134.561 1111.39 132.617 1109.66 Q130.695 1107.92 127.593 1107.92 Q125.394 1107.92 122.941 1108.68 Q120.51 1109.45 117.732 1111 L117.732 1106.28 Q120.556 1105.14 123.01 1104.56 Q125.464 1103.99 127.501 1103.99 Q132.871 1103.99 136.066 1106.67 Q139.26 1109.36 139.26 1113.85 Q139.26 1115.98 138.45 1117.9 Q137.663 1119.8 135.556 1122.39 Q134.978 1123.06 131.876 1126.28 Q128.774 1129.47 123.126 1135.24 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M129.862 756.309 L118.056 774.758 L129.862 774.758 L129.862 756.309 M128.635 752.235 L134.515 752.235 L134.515 774.758 L139.445 774.758 L139.445 778.647 L134.515 778.647 L134.515 786.795 L129.862 786.795 L129.862 778.647 L114.26 778.647 L114.26 774.133 L128.635 752.235 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M127.917 415.276 Q124.769 415.276 122.918 417.429 Q121.089 419.582 121.089 423.332 Q121.089 427.059 122.918 429.235 Q124.769 431.387 127.917 431.387 Q131.066 431.387 132.894 429.235 Q134.746 427.059 134.746 423.332 Q134.746 419.582 132.894 417.429 Q131.066 415.276 127.917 415.276 M137.2 400.624 L137.2 404.883 Q135.441 404.05 133.635 403.61 Q131.853 403.17 130.093 403.17 Q125.464 403.17 123.01 406.295 Q120.58 409.42 120.232 415.739 Q121.598 413.725 123.658 412.661 Q125.718 411.573 128.195 411.573 Q133.404 411.573 136.413 414.744 Q139.445 417.892 139.445 423.332 Q139.445 428.656 136.297 431.873 Q133.149 435.091 127.917 435.091 Q121.922 435.091 118.751 430.508 Q115.58 425.901 115.58 417.174 Q115.58 408.98 119.468 404.119 Q123.357 399.235 129.908 399.235 Q131.667 399.235 133.45 399.582 Q135.255 399.929 137.2 400.624 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M127.593 65.6323 Q124.26 65.6323 122.339 67.4147 Q120.441 69.197 120.441 72.322 Q120.441 75.447 122.339 77.2294 Q124.26 79.0118 127.593 79.0118 Q130.927 79.0118 132.848 77.2294 Q134.769 75.4239 134.769 72.322 Q134.769 69.197 132.848 67.4147 Q130.95 65.6323 127.593 65.6323 M122.918 63.6415 Q119.908 62.9008 118.218 60.8406 Q116.552 58.7804 116.552 55.8175 Q116.552 51.674 119.492 49.2666 Q122.455 46.8592 127.593 46.8592 Q132.755 46.8592 135.695 49.2666 Q138.635 51.674 138.635 55.8175 Q138.635 58.7804 136.945 60.8406 Q135.279 62.9008 132.292 63.6415 Q135.672 64.4286 137.547 66.7202 Q139.445 69.0119 139.445 72.322 Q139.445 77.3452 136.367 80.0303 Q133.311 82.7155 127.593 82.7155 Q121.876 82.7155 118.797 80.0303 Q115.742 77.3452 115.742 72.322 Q115.742 69.0119 117.64 66.7202 Q119.538 64.4286 122.918 63.6415 M121.205 56.2573 Q121.205 58.9425 122.871 60.4471 Q124.561 61.9517 127.593 61.9517 Q130.603 61.9517 132.292 60.4471 Q134.005 58.9425 134.005 56.2573 Q134.005 53.5721 132.292 52.0675 Q130.603 50.5629 127.593 50.5629 Q124.561 50.5629 122.871 52.0675 Q121.205 53.5721 121.205 56.2573 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M16.4842 750.521 L16.4842 720.475 L21.895 720.475 L21.895 744.092 L35.9632 744.092 L35.9632 721.462 L41.3741 721.462 L41.3741 744.092 L58.5933 744.092 L58.5933 719.902 L64.0042 719.902 L64.0042 750.521 L16.4842 750.521 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  237.067,1384.24 337.74,1379.14 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  337.74,1379.14 462.164,1372.1 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  462.164,1372.1 584.525,1364.19 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  584.525,1364.19 703.967,1355.21 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  703.967,1355.21 819.214,1344.92 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  819.214,1344.92 928.21,1333.02 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  928.21,1333.02 1027.78,1319.16 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  1027.78,1319.16 1113.25,1303.06 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  1113.25,1303.06 1179.01,1284.76 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  1179.01,1284.76 1220.85,1264.73 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  1220.85,1264.73 1238.63,1243.76 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  1238.63,1243.76 1239.77,1236.49 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1239.77,1236.49 1231.16,1215.22 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1231.16,1215.22 1208.75,1194.31 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1208.75,1194.31 1176.36,1173.56 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1176.36,1173.56 1137.49,1153.24 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1137.49,1153.24 1093.86,1132.99 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1093.86,1132.99 1047.69,1113.04 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1047.69,1113.04 999.59,1093.03 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  999.59,1093.03 951.173,1073.19 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  951.173,1073.19 902.57,1053.2 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  902.57,1053.2 855.069,1033.29 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  855.069,1033.29 808.591,1013.15 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  808.591,1013.15 764.232,993.029 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  764.232,993.029 721.831,972.64 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  721.831,972.64 682.333,952.24 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  682.333,952.24 645.558,931.551 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  645.558,931.551 612.304,910.848 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  612.304,910.848 582.405,889.857 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  582.405,889.857 556.496,868.867 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  556.496,868.867 534.438,847.611 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  534.438,847.611 516.935,826.72 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  516.935,826.72 503.319,805.265 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  503.319,805.265 494.177,783.892 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  494.177,783.892 489.433,762.328 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  489.433,762.328 488.739,750.329 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  488.739,750.329 490.948,728.888 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  490.948,728.888 497.598,707.338 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  497.598,707.338 508.538,685.961 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  508.538,685.961 523.805,664.521 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  523.805,664.521 543.098,643.295 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  543.098,643.295 566.516,622.046 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  566.516,622.046 593.628,601.043 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  593.628,601.043 624.607,580.047 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  624.607,580.047 658.916,559.322 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  658.916,559.322 696.806,538.625 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  696.806,538.625 737.653,518.214 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  737.653,518.214 781.793,497.845 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  781.793,497.845 828.532,477.769 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  828.532,477.769 878.284,457.744 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  878.284,457.744 930.3,438.014 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  930.3,438.014 985.072,418.338 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  985.072,418.338 1041.8,398.954 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1041.8,398.954 1101.05,379.624 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1101.05,379.624 1161.99,360.58 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1161.99,360.58 1225.23,341.588 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1225.23,341.588 1289.92,322.875 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1289.92,322.875 1356.74,304.21 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1356.74,304.21 1424.78,285.815 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1424.78,285.815 1494.78,267.462 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1494.78,267.462 1565.83,249.37 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1565.83,249.37 1638.7,231.315 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1638.7,231.315 1712.44,213.512 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1712.44,213.512 1787.88,195.74 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1787.88,195.74 1822.32,187.765 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  1822.32,187.765 1899.01,170.295 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  1899.01,170.295 1977.27,152.849 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  1977.27,152.849 2056.1,135.634 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  2056.1,135.634 2136.41,118.438 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  2136.41,118.438 2217.18,101.463 
  "/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="
  2217.18,101.463 2291.13,86.1857 
  "/>
<circle clip-path="url(#clip052)" cx="1239.77" cy="1236.49" r="10" fill="#0000ff" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="0"/>
<circle clip-path="url(#clip052)" cx="516.935" cy="826.72" r="10" fill="#ff0000" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="0"/>
<circle clip-path="url(#clip052)" cx="488.739" cy="750.329" r="10" fill="#0000ff" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="0"/>
<circle clip-path="url(#clip052)" cx="1822.32" cy="187.765" r="10" fill="#ff0000" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="0"/>
<circle clip-path="url(#clip052)" cx="1239.77" cy="1236.49" r="10" fill="#0000ff" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="0"/>
<circle clip-path="url(#clip052)" cx="516.935" cy="826.72" r="10" fill="#ff0000" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="0"/>
<path clip-path="url(#clip050)" d="
M248.022 248.629 L592.376 248.629 L592.376 93.1086 L248.022 93.1086  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  248.022,248.629 592.376,248.629 592.376,93.1086 248.022,93.1086 248.022,248.629 
  "/>
<circle clip-path="url(#clip050)" cx="344.792" cy="144.949" r="23" fill="#0000ff" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="0"/>
<path clip-path="url(#clip050)" d="M460.334 149.289 Q460.334 144.59 458.39 141.928 Q456.468 139.243 453.089 139.243 Q449.709 139.243 447.765 141.928 Q445.843 144.59 445.843 149.289 Q445.843 153.988 447.765 156.673 Q449.709 159.335 453.089 159.335 Q456.468 159.335 458.39 156.673 Q460.334 153.988 460.334 149.289 M445.843 140.238 Q447.186 137.923 449.223 136.812 Q451.283 135.678 454.13 135.678 Q458.853 135.678 461.792 139.428 Q464.755 143.178 464.755 149.289 Q464.755 155.4 461.792 159.15 Q458.853 162.9 454.13 162.9 Q451.283 162.9 449.223 161.789 Q447.186 160.655 445.843 158.34 L445.843 162.229 L441.561 162.229 L441.561 126.21 L445.843 126.21 L445.843 140.238 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M475.936 158.34 L475.936 172.09 L471.653 172.09 L471.653 136.303 L475.936 136.303 L475.936 140.238 Q477.278 137.923 479.315 136.812 Q481.376 135.678 484.223 135.678 Q488.945 135.678 491.885 139.428 Q494.848 143.178 494.848 149.289 Q494.848 155.4 491.885 159.15 Q488.945 162.9 484.223 162.9 Q481.376 162.9 479.315 161.789 Q477.278 160.655 475.936 158.34 M490.426 149.289 Q490.426 144.59 488.482 141.928 Q486.561 139.243 483.181 139.243 Q479.801 139.243 477.857 141.928 Q475.936 144.59 475.936 149.289 Q475.936 153.988 477.857 156.673 Q479.801 159.335 483.181 159.335 Q486.561 159.335 488.482 156.673 Q490.426 153.988 490.426 149.289 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><circle clip-path="url(#clip050)" cx="344.792" cy="196.789" r="23" fill="#ff0000" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="0"/>
<path clip-path="url(#clip050)" d="M463.274 198.421 L463.274 214.069 L459.015 214.069 L459.015 198.559 Q459.015 194.879 457.579 193.05 Q456.144 191.222 453.274 191.222 Q449.825 191.222 447.834 193.421 Q445.843 195.62 445.843 199.416 L445.843 214.069 L441.561 214.069 L441.561 178.05 L445.843 178.05 L445.843 192.171 Q447.371 189.833 449.431 188.675 Q451.515 187.518 454.223 187.518 Q458.69 187.518 460.982 190.296 Q463.274 193.05 463.274 198.421 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M481.815 191.129 Q478.389 191.129 476.399 193.814 Q474.408 196.476 474.408 201.129 Q474.408 205.782 476.376 208.467 Q478.366 211.129 481.815 211.129 Q485.218 211.129 487.209 208.444 Q489.2 205.758 489.2 201.129 Q489.2 196.522 487.209 193.837 Q485.218 191.129 481.815 191.129 M481.815 187.518 Q487.371 187.518 490.542 191.129 Q493.713 194.74 493.713 201.129 Q493.713 207.495 490.542 211.129 Q487.371 214.74 481.815 214.74 Q476.237 214.74 473.065 211.129 Q469.917 207.495 469.917 201.129 Q469.917 194.74 473.065 191.129 Q476.237 187.518 481.815 187.518 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M504.894 210.18 L504.894 223.93 L500.612 223.93 L500.612 188.143 L504.894 188.143 L504.894 192.078 Q506.237 189.763 508.274 188.652 Q510.334 187.518 513.181 187.518 Q517.903 187.518 520.843 191.268 Q523.806 195.018 523.806 201.129 Q523.806 207.24 520.843 210.99 Q517.903 214.74 513.181 214.74 Q510.334 214.74 508.274 213.629 Q506.237 212.495 504.894 210.18 M519.385 201.129 Q519.385 196.43 517.44 193.768 Q515.519 191.083 512.139 191.083 Q508.76 191.083 506.815 193.768 Q504.894 196.43 504.894 201.129 Q504.894 205.828 506.815 208.513 Q508.76 211.175 512.139 211.175 Q515.519 211.175 517.44 208.513 Q519.385 205.828 519.385 201.129 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M543.991 178.05 L543.991 181.592 L539.917 181.592 Q537.625 181.592 536.722 182.518 Q535.843 183.444 535.843 185.851 L535.843 188.143 L542.857 188.143 L542.857 191.453 L535.843 191.453 L535.843 214.069 L531.56 214.069 L531.56 191.453 L527.486 191.453 L527.486 188.143 L531.56 188.143 L531.56 186.337 Q531.56 182.009 533.574 180.041 Q535.588 178.05 539.963 178.05 L543.991 178.05 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<pre><code class="language-julia hljs">julia&gt; br
Branch number of points: 72
Branch of Equilibrium
Type of vectors: Vector{Float64}
Parameters E0 from -2.0 to -0.9
Special points:
 (ind_ev = index of the bifurcating eigenvalue e.g. `br.eig[idx].eigenvals[ind_ev]`)
- #  1,    bp at E0 ≈ -1.46302733 ∈ (-1.46302733, -1.46302733), |δp|=4e-14, [converged], δ = ( 1,  0), step =  12, eigenelements in eig[ 13], ind_ev =   1
- #  2,  hopf at E0 ≈ -1.85012460 ∈ (-1.85012460, -1.85012447), |δp|=1e-07, [converged], δ = ( 2,  2), step =  32, eigenelements in eig[ 33], ind_ev =   3
- #  3,    bp at E0 ≈ -1.86522391 ∈ (-1.86522391, -1.86522391), |δp|=2e-15, [converged], δ = (-1,  0), step =  36, eigenelements in eig[ 37], ind_ev =   3
- #  4,  hopf at E0 ≈ -1.15105934 ∈ (-1.15105942, -1.15105934), |δp|=8e-08, [converged], δ = (-2, -2), step =  65, eigenelements in eig[ 66], ind_ev =   2</code></pre><h2 id="Branch-of-periodic-orbits-with-finite-differences"><a class="docs-heading-anchor" href="#Branch-of-periodic-orbits-with-finite-differences">Branch of periodic orbits with finite differences</a><a id="Branch-of-periodic-orbits-with-finite-differences-1"></a><a class="docs-heading-anchor-permalink" href="#Branch-of-periodic-orbits-with-finite-differences" title="Permalink"></a></h2><p>We then compute the branch of periodic orbits from the last Hopf bifurcation point (on the right). We use finite differences to discretize the problem of finding periodic orbits. Obviously, this will be problematic when the period of the limit cycle grows unbounded close to the homoclinic orbit.</p><pre><code class="language-julia hljs"># newton parameters
optn_po = NewtonPar(verbose = true, tol = 1e-8,  maxIter = 10) 

# continuation parameters
opts_po_cont = ContinuationPar(dsmax = 0.1, ds= -0.0001, dsmin = 1e-4, pMax = 0., pMin=-5.,
	maxSteps = 110, newtonOptions = (@set optn_po.tol = 1e-7),
	nev = 2, precisionStability = 1e-8, detectBifurcation = 3, plotEveryStep = 10, saveSolEveryStep=1)

Mt = 200 # number of time sections
	br_potrap, utrap = continuation(jet...,
	# we want to branch form the 4th bif. point
	br, 4, opts_po_cont,
	# we want to use the Trapeze method to locate PO
	PeriodicOrbitTrapProblem(M = Mt);
	# this jacobian is specific to ODEs
	# it is computed using AD of the flow and
	# updated inplace
	linearPO = :Dense,
	# regular continuation options
	verbosity = 2,	plot = true,
	recordFromSolution = (x, p) -&gt; (xtt=reshape(x[1:end-1],3,Mt); return (max = maximum(xtt[1,:]), min = minimum(xtt[1,:]), period = x[end])),
	plotSolution = (x, p; k...) -&gt; begin
		# the problem prob is passed back in p:
		xtt = BK.getTrajectory(p.prob, x, p.p)
		plot!(xtt.t, xtt.u[1,:]; label = &quot;E&quot;, k...)
		plot!(xtt.t, xtt.u[2,:]; label = &quot;x&quot;, k...)
		plot!(xtt.t, xtt.u[3,:]; label = &quot;u&quot;, k...)
		plot!(br,subplot=1, putbifptlegend = false)
		end,
	normC = norminf)

scene = plot(br, br_potrap, markersize = 3)
plot!(scene, br_potrap.param, br_potrap.min, label = &quot;&quot;)</code></pre><p><img src="../ex1ODE1a.png" alt/></p><p>We plot the maximum (resp. minimum) of the limit cycle. We can see that the min converges to the smallest equilibrium indicating a homoclinic orbit.</p><h2 id="Periodic-orbits-with-Parallel-Standard-Shooting"><a class="docs-heading-anchor" href="#Periodic-orbits-with-Parallel-Standard-Shooting">Periodic orbits with Parallel Standard Shooting</a><a id="Periodic-orbits-with-Parallel-Standard-Shooting-1"></a><a class="docs-heading-anchor-permalink" href="#Periodic-orbits-with-Parallel-Standard-Shooting" title="Permalink"></a></h2><p>We use a different method to compute periodic orbits: we rely on a fixed point of the flow. To compute the flow, we use <code>DifferentialEquations.jl</code>. This way of computing periodic orbits should be more precise than the previous one. We use a particular instance called multiple shooting which is computed in parallel. This is an additional advantage compared to the previous method.</p><pre><code class="language-julia hljs">using DifferentialEquations

# this is the ODEProblem used with `DiffEqBase.solve`
probsh = ODEProblem(TMvf!, copy(z0), (0., 1000.), par_tm; atol = 1e-10, rtol = 1e-9)

opts_po_cont = ContinuationPar(dsmax = 0.05, ds= -0.0001, dsmin = 1e-4, pMax = 0., pMin=-5., maxSteps = 210, newtonOptions = (@set optn_po.tol = 1e-6), nev = 25, precisionStability = 1e-8, detectBifurcation = 0, plotEveryStep = 10, saveSolEveryStep=0)

br_posh, = @time continuation(jet...,
	br, 4, opts_po_cont,
	# this is where we tell that we want Standard Shooting
	# with 15 time sections
	ShootingProblem(15, par_tm, probsh, Rodas4(), parallel = true);
	# this to help branching
	ampfactor = 1.0, δp = 0.0005,
	# deflation helps not converging to an equilibrium instead of a PO
	usedeflation = true,
	# this linear solver is specific to ODEs
	# it is computed using AD of the flow and
	# updated inplace
	linearPO = :autodiffDense,
	# we update the section along the branches
	updateSectionEveryStep = 2,
	# regular continuation parameters
	verbosity = 2,	plot = true,
	recordFromSolution = (x, p) -&gt; (return (max = getMaximum(p.prob, x, @set par_tm.E0 = p.p), period = getPeriod(p.prob, x, @set par_tm.E0 = p.p))),
	plotSolution = (x, p; k...) -&gt;
		begin
			xtt = BK.getTrajectory(p.prob, x, @set par_tm.E0 = p.p)
			plot!(xtt; legend = false, k...);
			plot!(br, subplot=1, putbifptlegend = false)
		end,
	normC = norminf)</code></pre><p><img src="../ex1ODE3.png" alt/></p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Cortes"><a class="tag is-link" href="#citeref-Cortes">Cortes</a><blockquote><p>Cortes, Jesus M., Mathieu Desroches, Serafim Rodrigues, Romain Veltz, Miguel A. Muñoz, and Terrence J. Sejnowski. <strong>Short-Term Synaptic Plasticity in the Deterministic Tsodyks–Markram Model Leads to Unpredictable Network Dynamics.</strong>” Proceedings of the National Academy of Sciences 110, no. 41 (October 8, 2013): 16610–15. https://doi.org/10.1073/pnas.1316071110.</p></blockquote></li></ul></section></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.4 on <span class="colophon-date" title="Monday 26 July 2021 11:59">Monday 26 July 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
