<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Temperature model (Simplest example) · Bifurcation Analysis in Julia</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Bifurcation Analysis in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bifurcation Analysis in Julia</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../guidelines/">Overview</a></li><li><a class="tocitem" href="../tutorials/">Tutorials</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Functionalities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../periodicOrbit/">Introduction</a></li><li><a class="tocitem" href="../periodicOrbitTrapeze/">Finite Differences</a></li><li><a class="tocitem" href="../periodicOrbitShooting/">Shooting</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Continuation methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../IntroContinuation/">Introduction</a></li><li><a class="tocitem" href="../Predictors/">Predictors / correctors</a></li><li><a class="tocitem" href="../PALC/">PALC</a></li><li><a class="tocitem" href="../MooreSpence/">Moore Spence Continuation</a></li><li><a class="tocitem" href="../DeflatedContinuation/">Deflated Continuation</a></li></ul></li><li><a class="tocitem" href="../EventCallback/">Event Handling and Callback</a></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Bifurcations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../detectionBifurcation/">Bifurcation detection (codim 1)</a></li><li><a class="tocitem" href="../codim2Continuation/">Fold / Hopf Continuation (codim 2)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Normal form</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../simplebp/">Simple branch point</a></li><li><a class="tocitem" href="../nonsimplebp/">Non-simple branch point</a></li><li><a class="tocitem" href="../simplehopf/">Simple Hopf point</a></li></ul></li><li><a class="tocitem" href="../branchswitching/">Branch switching</a></li><li><a class="tocitem" href="../BifurcationDiagram/">Bifurcation diagram</a></li><li><a class="tocitem" href="../deflatedproblem/">Deflated problems</a></li><li><a class="tocitem" href="../constrainedproblem/">Constrained problem</a></li><li><a class="tocitem" href="../diffeq/">DiffEq wrapper</a></li><li><a class="tocitem" href="../iterator/">Iterator Interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Options</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../linearsolver/">Linear Solvers</a></li><li><a class="tocitem" href="../borderedlinearsolver/">Bordered linear solvers</a></li><li><a class="tocitem" href="../eigensolver/">Eigen Solvers</a></li><li><a class="tocitem" href="../Borderedarrays/">Bordered arrays</a></li></ul></li><li><a class="tocitem" href="../faq/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Temperature model (Simplest example)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Temperature model (Simplest example)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rveltz/BifurcationKit.jl/blob/master/docs/src/tutorials1.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Temperature-model-(Simplest-example)"><a class="docs-heading-anchor" href="#Temperature-model-(Simplest-example)">Temperature model (Simplest example)</a><a id="Temperature-model-(Simplest-example)-1"></a><a class="docs-heading-anchor-permalink" href="#Temperature-model-(Simplest-example)" title="Permalink"></a></h1><ul><li><a href="#Temperature-model-(Simplest-example)">Temperature model (Simplest example)</a></li><ul><li><a href="#Continuation-of-Fold-points">Continuation of Fold points</a></li><li><a href="#Using-GMRES-or-another-linear-solver">Using GMRES or another linear solver</a></li></ul></ul><blockquote><p>This is a classical example from the <strong>Trilinos</strong> library.</p></blockquote><p>This is a simple example in which we aim at solving <span>$\Delta T+\alpha N(T,\beta)=0$</span> with boundary conditions <span>$T(0) = T(1)=\beta$</span>. This example is coded in <code>examples/chan.jl</code>. We start with some imports:</p><pre><code class="language-julia hljs">using BifurcationKit, LinearAlgebra, Plots, Parameters, Setfield
# Setfield.jl is used to provide the parameter axis @lens
const BK = BifurcationKit

N(x; a = 0.5, b = 0.01) = 1 + (x + a*x^2)/(1 + b*x^2)</code></pre><p>We then write our functional:</p><pre><code class="language-julia hljs">function F_chan(x, p)
	@unpack α, β = p
	f = similar(x)
	n = length(x)
	f[1] = x[1] - β
	f[n] = x[n] - β
	for i=2:n-1
		f[i] = (x[i-1] - 2 * x[i] + x[i+1]) * (n-1)^2 + α * N(x[i], b = β)
	end
	return f
end</code></pre><p>We want to call a Newton solver. We first need an initial guess:</p><pre><code class="language-julia hljs">n = 101
sol = [(i-1)*(n-i)/n^2+0.1 for i=1:n]

# set of parameters
par = (α = 3.3, β = 0.01)</code></pre><p>Finally, we need to provide some parameters for the Newton iterations. This is done by calling</p><pre><code class="language-julia hljs">optnewton = NewtonPar(tol = 1e-11, verbose = true)</code></pre><p>We call the Newton solver:</p><pre><code class="language-julia hljs">out, = @time newton( F_chan, sol, par, optnewton)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
┌─────────────────────────────────────────────────────┐
│ Newton Iterations      f(x)      Linear Iterations  │
├─────────────┬──────────────────────┬────────────────┤
│       0     │       2.3440e+01     │        0       │
│       1     │       1.3774e+00     │        1       │
│       2     │       1.6268e-02     │        1       │
│       3     │       2.4535e-06     │        1       │
│       4     │       4.0322e-11     │        1       │
│       5     │       5.1828e-12     │        1       │
└─────────────┴──────────────────────┴────────────────┘
  0.002957 seconds (2.39 k allocations: 2.735 MiB)</code></pre><p>Note that, in this case, we did not give the Jacobian. It was computed internally using Finite Differences. </p><blockquote><p>This is not as bad as it looks despite the fact that there are so many allocations even with Finite Differences Jacobian. Using <code>BenchmarkTools.jl</code>, one actually finds <code>1.153 ms (2067 allocations: 2.04 MiB)</code>. This is reasonable as we did not code the problem with much care...</p></blockquote><p>We can perform numerical continuation w.r.t. the parameter <span>$\alpha$</span>. This time, we need to provide additional parameters, but now for the continuation method:</p><pre><code class="language-julia hljs">optcont = ContinuationPar(dsmin = 0.01, dsmax = 0.2, ds= 0.1, pMin = 0., pMax = 4.1, newtonOptions = NewtonPar(maxIter = 10, tol = 1e-9))</code></pre><p>Next, we call the continuation routine as follows.</p><pre><code class="language-julia hljs">br, = continuation(F_chan, out, par, (@lens _.α),
		optcont; plot = true, verbosity = 0,
		# function to plot the solution
		plotSolution = (x, p; k...) -&gt; plot!(x; ylabel=&quot;solution&quot;, label=&quot;&quot;, k...))
nothing #hide</code></pre><p>The parameter axis <code>lens = @lens _.α</code> is used to extract the component of <code>par</code> corresponding to <code>α</code>. Internally, it is used as <code>get(par, lens)</code> which returns <code>3.3</code>.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>We don&#39;t need to call <code>newton</code> first in order to use <code>continuation</code>.</p></div></div><p>You should see <img src="../chan-ex.png" alt/></p><p>The left figure is the norm of the solution as function of the parameter <span>$p=\alpha$</span>, the <em>y-axis</em> can be changed by passing a different <code>recordFromSolution</code> to <code>continuation</code>. The top right figure is the value of <span>$\alpha$</span> as function of the iteration number. The bottom right is the solution for the current value of the parameter. This last plot can be modified by changing the argument <code>plotSolution</code> to <code>continuation</code>.</p><div class="admonition is-info"><header class="admonition-header">Bif. point detection</header><div class="admonition-body"><p>Two Fold points were detected. This can be seen by looking at <code>br.specialpoint</code>, by the black	dots on the continuation plots when doing <code>plot(br, plotfold=true)</code> or by typing <code>br</code> in the REPL. Note that the bifurcation points are located in <code>br.specialpoint</code>.</p></div></div><h2 id="Continuation-of-Fold-points"><a class="docs-heading-anchor" href="#Continuation-of-Fold-points">Continuation of Fold points</a><a id="Continuation-of-Fold-points-1"></a><a class="docs-heading-anchor-permalink" href="#Continuation-of-Fold-points" title="Permalink"></a></h2><p>We get a summary of the branch by doing</p><pre><code class="language-julia hljs">julia&gt; br
Branch number of points: 78
Branch of Equilibrium
Fold points:
- #  1,    fold at p ≈ 4.03926020, step =   6, eigenelements in eig[  6], ind_ev =   0 [    guess]
- #  2,    fold at p ≈ 3.15599445, step =  24, eigenelements in eig[ 24], ind_ev =   0 [    guess]</code></pre><p>We can take the first Fold point, which has been guessed during the previous continuation run and locate it precisely. However, this only works well when the jacobian is computed analytically. We use automatic differentiation for that</p><pre><code class="language-julia hljs">using ForwardDiff

# Jacobian of F_chan
Jac_mat = (x,p) -&gt; ForwardDiff.jacobian(z -&gt; F_chan(z,p),x)

# index of the Fold bifurcation point in br.specialpoint
indfold = 2

outfold, _, flag = newton(F_chan, Jac_mat,
	#index of the fold point
	br, indfold)
flag &amp;&amp; printstyled(color=:red, &quot;--&gt; We found a Fold Point at α = &quot;, outfold.p, &quot;, β = 0.01, from &quot;, br.specialpoint[indfold].param,&quot;\n&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">--&gt; We found a Fold Point at α = 3.1556507316108027, β = 0.01, from 3.1557201933432246</code></pre><p>We can finally continue this fold point in the plane <span>$(α,β)$</span> by performing a Fold Point continuation. In the present case, we find a Cusp point.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>We don&#39;t need to call <code>newton</code> first in order to use <code>continuation</code> for the codim 2 curve of bifurcation points.</p></div></div><pre><code class="language-julia hljs">outfoldco, = continuation(
	F_chan, Jac_mat,
	br, indfold,
	# second parameter axis to use for codim 2 curve
	(@lens _.β),
	plot = true, verbosity = 2)
scene = plot(outfoldco, plotfold=true, legend = :bottomright)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip600">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip600)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip601">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip600)" d="
M250.352 1423.18 L2352.76 1423.18 L2352.76 47.2441 L250.352 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip602">
    <rect x="250" y="47" width="2103" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip602)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  309.854,1423.18 309.854,47.2441 
  "/>
<polyline clip-path="url(#clip602)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  662.56,1423.18 662.56,47.2441 
  "/>
<polyline clip-path="url(#clip602)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1015.27,1423.18 1015.27,47.2441 
  "/>
<polyline clip-path="url(#clip602)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1367.97,1423.18 1367.97,47.2441 
  "/>
<polyline clip-path="url(#clip602)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1720.68,1423.18 1720.68,47.2441 
  "/>
<polyline clip-path="url(#clip602)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2073.38,1423.18 2073.38,47.2441 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  250.352,1423.18 2352.76,1423.18 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  309.854,1423.18 309.854,1404.28 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  662.56,1423.18 662.56,1404.28 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1015.27,1423.18 1015.27,1404.28 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1367.97,1423.18 1367.97,1404.28 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1720.68,1423.18 1720.68,1404.28 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2073.38,1423.18 2073.38,1404.28 
  "/>
<path clip-path="url(#clip600)" d="M257.077 1452.37 Q253.466 1452.37 251.637 1455.94 Q249.831 1459.48 249.831 1466.61 Q249.831 1473.71 251.637 1477.28 Q253.466 1480.82 257.077 1480.82 Q260.711 1480.82 262.516 1477.28 Q264.345 1473.71 264.345 1466.61 Q264.345 1459.48 262.516 1455.94 Q260.711 1452.37 257.077 1452.37 M257.077 1448.67 Q262.887 1448.67 265.942 1453.27 Q269.021 1457.86 269.021 1466.61 Q269.021 1475.33 265.942 1479.94 Q262.887 1484.52 257.077 1484.52 Q251.267 1484.52 248.188 1479.94 Q245.132 1475.33 245.132 1466.61 Q245.132 1457.86 248.188 1453.27 Q251.267 1448.67 257.077 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M277.239 1477.97 L282.123 1477.97 L282.123 1483.85 L277.239 1483.85 L277.239 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M302.308 1452.37 Q298.697 1452.37 296.868 1455.94 Q295.063 1459.48 295.063 1466.61 Q295.063 1473.71 296.868 1477.28 Q298.697 1480.82 302.308 1480.82 Q305.942 1480.82 307.748 1477.28 Q309.576 1473.71 309.576 1466.61 Q309.576 1459.48 307.748 1455.94 Q305.942 1452.37 302.308 1452.37 M302.308 1448.67 Q308.118 1448.67 311.174 1453.27 Q314.252 1457.86 314.252 1466.61 Q314.252 1475.33 311.174 1479.94 Q308.118 1484.52 302.308 1484.52 Q296.498 1484.52 293.419 1479.94 Q290.364 1475.33 290.364 1466.61 Q290.364 1457.86 293.419 1453.27 Q296.498 1448.67 302.308 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M332.47 1452.37 Q328.859 1452.37 327.03 1455.94 Q325.224 1459.48 325.224 1466.61 Q325.224 1473.71 327.03 1477.28 Q328.859 1480.82 332.47 1480.82 Q336.104 1480.82 337.91 1477.28 Q339.738 1473.71 339.738 1466.61 Q339.738 1459.48 337.91 1455.94 Q336.104 1452.37 332.47 1452.37 M332.47 1448.67 Q338.28 1448.67 341.336 1453.27 Q344.414 1457.86 344.414 1466.61 Q344.414 1475.33 341.336 1479.94 Q338.28 1484.52 332.47 1484.52 Q326.66 1484.52 323.581 1479.94 Q320.525 1475.33 320.525 1466.61 Q320.525 1457.86 323.581 1453.27 Q326.66 1448.67 332.47 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M362.632 1452.37 Q359.021 1452.37 357.192 1455.94 Q355.386 1459.48 355.386 1466.61 Q355.386 1473.71 357.192 1477.28 Q359.021 1480.82 362.632 1480.82 Q366.266 1480.82 368.071 1477.28 Q369.9 1473.71 369.9 1466.61 Q369.9 1459.48 368.071 1455.94 Q366.266 1452.37 362.632 1452.37 M362.632 1448.67 Q368.442 1448.67 371.497 1453.27 Q374.576 1457.86 374.576 1466.61 Q374.576 1475.33 371.497 1479.94 Q368.442 1484.52 362.632 1484.52 Q356.822 1484.52 353.743 1479.94 Q350.687 1475.33 350.687 1466.61 Q350.687 1457.86 353.743 1453.27 Q356.822 1448.67 362.632 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M610.28 1452.37 Q606.669 1452.37 604.84 1455.94 Q603.035 1459.48 603.035 1466.61 Q603.035 1473.71 604.84 1477.28 Q606.669 1480.82 610.28 1480.82 Q613.914 1480.82 615.72 1477.28 Q617.548 1473.71 617.548 1466.61 Q617.548 1459.48 615.72 1455.94 Q613.914 1452.37 610.28 1452.37 M610.28 1448.67 Q616.09 1448.67 619.146 1453.27 Q622.224 1457.86 622.224 1466.61 Q622.224 1475.33 619.146 1479.94 Q616.09 1484.52 610.28 1484.52 Q604.47 1484.52 601.391 1479.94 Q598.335 1475.33 598.335 1466.61 Q598.335 1457.86 601.391 1453.27 Q604.47 1448.67 610.28 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M630.442 1477.97 L635.326 1477.97 L635.326 1483.85 L630.442 1483.85 L630.442 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M655.511 1452.37 Q651.9 1452.37 650.071 1455.94 Q648.266 1459.48 648.266 1466.61 Q648.266 1473.71 650.071 1477.28 Q651.9 1480.82 655.511 1480.82 Q659.145 1480.82 660.951 1477.28 Q662.78 1473.71 662.78 1466.61 Q662.78 1459.48 660.951 1455.94 Q659.145 1452.37 655.511 1452.37 M655.511 1448.67 Q661.321 1448.67 664.377 1453.27 Q667.455 1457.86 667.455 1466.61 Q667.455 1475.33 664.377 1479.94 Q661.321 1484.52 655.511 1484.52 Q649.701 1484.52 646.622 1479.94 Q643.567 1475.33 643.567 1466.61 Q643.567 1457.86 646.622 1453.27 Q649.701 1448.67 655.511 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M685.673 1452.37 Q682.062 1452.37 680.233 1455.94 Q678.428 1459.48 678.428 1466.61 Q678.428 1473.71 680.233 1477.28 Q682.062 1480.82 685.673 1480.82 Q689.307 1480.82 691.113 1477.28 Q692.941 1473.71 692.941 1466.61 Q692.941 1459.48 691.113 1455.94 Q689.307 1452.37 685.673 1452.37 M685.673 1448.67 Q691.483 1448.67 694.539 1453.27 Q697.617 1457.86 697.617 1466.61 Q697.617 1475.33 694.539 1479.94 Q691.483 1484.52 685.673 1484.52 Q679.863 1484.52 676.784 1479.94 Q673.729 1475.33 673.729 1466.61 Q673.729 1457.86 676.784 1453.27 Q679.863 1448.67 685.673 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M705.881 1449.29 L724.238 1449.29 L724.238 1453.23 L710.164 1453.23 L710.164 1461.7 Q711.182 1461.35 712.201 1461.19 Q713.219 1461 714.238 1461 Q720.025 1461 723.404 1464.18 Q726.784 1467.35 726.784 1472.76 Q726.784 1478.34 723.312 1481.44 Q719.839 1484.52 713.52 1484.52 Q711.344 1484.52 709.076 1484.15 Q706.83 1483.78 704.423 1483.04 L704.423 1478.34 Q706.506 1479.48 708.728 1480.03 Q710.951 1480.59 713.427 1480.59 Q717.432 1480.59 719.77 1478.48 Q722.108 1476.38 722.108 1472.76 Q722.108 1469.15 719.77 1467.05 Q717.432 1464.94 713.427 1464.94 Q711.552 1464.94 709.677 1465.36 Q707.826 1465.77 705.881 1466.65 L705.881 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M962.488 1452.37 Q958.877 1452.37 957.048 1455.94 Q955.242 1459.48 955.242 1466.61 Q955.242 1473.71 957.048 1477.28 Q958.877 1480.82 962.488 1480.82 Q966.122 1480.82 967.927 1477.28 Q969.756 1473.71 969.756 1466.61 Q969.756 1459.48 967.927 1455.94 Q966.122 1452.37 962.488 1452.37 M962.488 1448.67 Q968.298 1448.67 971.353 1453.27 Q974.432 1457.86 974.432 1466.61 Q974.432 1475.33 971.353 1479.94 Q968.298 1484.52 962.488 1484.52 Q956.677 1484.52 953.599 1479.94 Q950.543 1475.33 950.543 1466.61 Q950.543 1457.86 953.599 1453.27 Q956.677 1448.67 962.488 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M982.65 1477.97 L987.534 1477.97 L987.534 1483.85 L982.65 1483.85 L982.65 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1007.72 1452.37 Q1004.11 1452.37 1002.28 1455.94 Q1000.47 1459.48 1000.47 1466.61 Q1000.47 1473.71 1002.28 1477.28 Q1004.11 1480.82 1007.72 1480.82 Q1011.35 1480.82 1013.16 1477.28 Q1014.99 1473.71 1014.99 1466.61 Q1014.99 1459.48 1013.16 1455.94 Q1011.35 1452.37 1007.72 1452.37 M1007.72 1448.67 Q1013.53 1448.67 1016.58 1453.27 Q1019.66 1457.86 1019.66 1466.61 Q1019.66 1475.33 1016.58 1479.94 Q1013.53 1484.52 1007.72 1484.52 Q1001.91 1484.52 998.83 1479.94 Q995.774 1475.33 995.774 1466.61 Q995.774 1457.86 998.83 1453.27 Q1001.91 1448.67 1007.72 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1028.69 1479.92 L1036.33 1479.92 L1036.33 1453.55 L1028.02 1455.22 L1028.02 1450.96 L1036.28 1449.29 L1040.96 1449.29 L1040.96 1479.92 L1048.6 1479.92 L1048.6 1483.85 L1028.69 1483.85 L1028.69 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1068.04 1452.37 Q1064.43 1452.37 1062.6 1455.94 Q1060.8 1459.48 1060.8 1466.61 Q1060.8 1473.71 1062.6 1477.28 Q1064.43 1480.82 1068.04 1480.82 Q1071.68 1480.82 1073.48 1477.28 Q1075.31 1473.71 1075.31 1466.61 Q1075.31 1459.48 1073.48 1455.94 Q1071.68 1452.37 1068.04 1452.37 M1068.04 1448.67 Q1073.85 1448.67 1076.91 1453.27 Q1079.99 1457.86 1079.99 1466.61 Q1079.99 1475.33 1076.91 1479.94 Q1073.85 1484.52 1068.04 1484.52 Q1062.23 1484.52 1059.15 1479.94 Q1056.1 1475.33 1056.1 1466.61 Q1056.1 1457.86 1059.15 1453.27 Q1062.23 1448.67 1068.04 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1315.69 1452.37 Q1312.08 1452.37 1310.25 1455.94 Q1308.45 1459.48 1308.45 1466.61 Q1308.45 1473.71 1310.25 1477.28 Q1312.08 1480.82 1315.69 1480.82 Q1319.32 1480.82 1321.13 1477.28 Q1322.96 1473.71 1322.96 1466.61 Q1322.96 1459.48 1321.13 1455.94 Q1319.32 1452.37 1315.69 1452.37 M1315.69 1448.67 Q1321.5 1448.67 1324.56 1453.27 Q1327.64 1457.86 1327.64 1466.61 Q1327.64 1475.33 1324.56 1479.94 Q1321.5 1484.52 1315.69 1484.52 Q1309.88 1484.52 1306.8 1479.94 Q1303.75 1475.33 1303.75 1466.61 Q1303.75 1457.86 1306.8 1453.27 Q1309.88 1448.67 1315.69 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1335.85 1477.97 L1340.74 1477.97 L1340.74 1483.85 L1335.85 1483.85 L1335.85 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1360.92 1452.37 Q1357.31 1452.37 1355.48 1455.94 Q1353.68 1459.48 1353.68 1466.61 Q1353.68 1473.71 1355.48 1477.28 Q1357.31 1480.82 1360.92 1480.82 Q1364.56 1480.82 1366.36 1477.28 Q1368.19 1473.71 1368.19 1466.61 Q1368.19 1459.48 1366.36 1455.94 Q1364.56 1452.37 1360.92 1452.37 M1360.92 1448.67 Q1366.73 1448.67 1369.79 1453.27 Q1372.87 1457.86 1372.87 1466.61 Q1372.87 1475.33 1369.79 1479.94 Q1366.73 1484.52 1360.92 1484.52 Q1355.11 1484.52 1352.03 1479.94 Q1348.98 1475.33 1348.98 1466.61 Q1348.98 1457.86 1352.03 1453.27 Q1355.11 1448.67 1360.92 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1381.89 1479.92 L1389.53 1479.92 L1389.53 1453.55 L1381.22 1455.22 L1381.22 1450.96 L1389.49 1449.29 L1394.16 1449.29 L1394.16 1479.92 L1401.8 1479.92 L1401.8 1483.85 L1381.89 1483.85 L1381.89 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1411.29 1449.29 L1429.65 1449.29 L1429.65 1453.23 L1415.57 1453.23 L1415.57 1461.7 Q1416.59 1461.35 1417.61 1461.19 Q1418.63 1461 1419.65 1461 Q1425.44 1461 1428.82 1464.18 Q1432.19 1467.35 1432.19 1472.76 Q1432.19 1478.34 1428.72 1481.44 Q1425.25 1484.52 1418.93 1484.52 Q1416.76 1484.52 1414.49 1484.15 Q1412.24 1483.78 1409.83 1483.04 L1409.83 1478.34 Q1411.92 1479.48 1414.14 1480.03 Q1416.36 1480.59 1418.84 1480.59 Q1422.84 1480.59 1425.18 1478.48 Q1427.52 1476.38 1427.52 1472.76 Q1427.52 1469.15 1425.18 1467.05 Q1422.84 1464.94 1418.84 1464.94 Q1416.96 1464.94 1415.09 1465.36 Q1413.24 1465.77 1411.29 1466.65 L1411.29 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1667.9 1452.37 Q1664.29 1452.37 1662.46 1455.94 Q1660.65 1459.48 1660.65 1466.61 Q1660.65 1473.71 1662.46 1477.28 Q1664.29 1480.82 1667.9 1480.82 Q1671.53 1480.82 1673.34 1477.28 Q1675.17 1473.71 1675.17 1466.61 Q1675.17 1459.48 1673.34 1455.94 Q1671.53 1452.37 1667.9 1452.37 M1667.9 1448.67 Q1673.71 1448.67 1676.76 1453.27 Q1679.84 1457.86 1679.84 1466.61 Q1679.84 1475.33 1676.76 1479.94 Q1673.71 1484.52 1667.9 1484.52 Q1662.09 1484.52 1659.01 1479.94 Q1655.95 1475.33 1655.95 1466.61 Q1655.95 1457.86 1659.01 1453.27 Q1662.09 1448.67 1667.9 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1688.06 1477.97 L1692.94 1477.97 L1692.94 1483.85 L1688.06 1483.85 L1688.06 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1713.13 1452.37 Q1709.52 1452.37 1707.69 1455.94 Q1705.88 1459.48 1705.88 1466.61 Q1705.88 1473.71 1707.69 1477.28 Q1709.52 1480.82 1713.13 1480.82 Q1716.76 1480.82 1718.57 1477.28 Q1720.4 1473.71 1720.4 1466.61 Q1720.4 1459.48 1718.57 1455.94 Q1716.76 1452.37 1713.13 1452.37 M1713.13 1448.67 Q1718.94 1448.67 1722 1453.27 Q1725.07 1457.86 1725.07 1466.61 Q1725.07 1475.33 1722 1479.94 Q1718.94 1484.52 1713.13 1484.52 Q1707.32 1484.52 1704.24 1479.94 Q1701.19 1475.33 1701.19 1466.61 Q1701.19 1457.86 1704.24 1453.27 Q1707.32 1448.67 1713.13 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1737.32 1479.92 L1753.64 1479.92 L1753.64 1483.85 L1731.69 1483.85 L1731.69 1479.92 Q1734.36 1477.16 1738.94 1472.53 Q1743.55 1467.88 1744.73 1466.54 Q1746.97 1464.01 1747.85 1462.28 Q1748.75 1460.52 1748.75 1458.83 Q1748.75 1456.07 1746.81 1454.34 Q1744.89 1452.6 1741.79 1452.6 Q1739.59 1452.6 1737.13 1453.37 Q1734.7 1454.13 1731.93 1455.68 L1731.93 1450.96 Q1734.75 1449.82 1737.2 1449.25 Q1739.66 1448.67 1741.69 1448.67 Q1747.06 1448.67 1750.26 1451.35 Q1753.45 1454.04 1753.45 1458.53 Q1753.45 1460.66 1752.64 1462.58 Q1751.86 1464.48 1749.75 1467.07 Q1749.17 1467.74 1746.07 1470.96 Q1742.97 1474.15 1737.32 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1773.45 1452.37 Q1769.84 1452.37 1768.01 1455.94 Q1766.21 1459.48 1766.21 1466.61 Q1766.21 1473.71 1768.01 1477.28 Q1769.84 1480.82 1773.45 1480.82 Q1777.09 1480.82 1778.89 1477.28 Q1780.72 1473.71 1780.72 1466.61 Q1780.72 1459.48 1778.89 1455.94 Q1777.09 1452.37 1773.45 1452.37 M1773.45 1448.67 Q1779.26 1448.67 1782.32 1453.27 Q1785.4 1457.86 1785.4 1466.61 Q1785.4 1475.33 1782.32 1479.94 Q1779.26 1484.52 1773.45 1484.52 Q1767.64 1484.52 1764.56 1479.94 Q1761.51 1475.33 1761.51 1466.61 Q1761.51 1457.86 1764.56 1453.27 Q1767.64 1448.67 1773.45 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M2021.1 1452.37 Q2017.49 1452.37 2015.66 1455.94 Q2013.86 1459.48 2013.86 1466.61 Q2013.86 1473.71 2015.66 1477.28 Q2017.49 1480.82 2021.1 1480.82 Q2024.74 1480.82 2026.54 1477.28 Q2028.37 1473.71 2028.37 1466.61 Q2028.37 1459.48 2026.54 1455.94 Q2024.74 1452.37 2021.1 1452.37 M2021.1 1448.67 Q2026.91 1448.67 2029.97 1453.27 Q2033.05 1457.86 2033.05 1466.61 Q2033.05 1475.33 2029.97 1479.94 Q2026.91 1484.52 2021.1 1484.52 Q2015.29 1484.52 2012.21 1479.94 Q2009.16 1475.33 2009.16 1466.61 Q2009.16 1457.86 2012.21 1453.27 Q2015.29 1448.67 2021.1 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M2041.26 1477.97 L2046.15 1477.97 L2046.15 1483.85 L2041.26 1483.85 L2041.26 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M2066.33 1452.37 Q2062.72 1452.37 2060.89 1455.94 Q2059.09 1459.48 2059.09 1466.61 Q2059.09 1473.71 2060.89 1477.28 Q2062.72 1480.82 2066.33 1480.82 Q2069.97 1480.82 2071.77 1477.28 Q2073.6 1473.71 2073.6 1466.61 Q2073.6 1459.48 2071.77 1455.94 Q2069.97 1452.37 2066.33 1452.37 M2066.33 1448.67 Q2072.14 1448.67 2075.2 1453.27 Q2078.28 1457.86 2078.28 1466.61 Q2078.28 1475.33 2075.2 1479.94 Q2072.14 1484.52 2066.33 1484.52 Q2060.52 1484.52 2057.44 1479.94 Q2054.39 1475.33 2054.39 1466.61 Q2054.39 1457.86 2057.44 1453.27 Q2060.52 1448.67 2066.33 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M2090.52 1479.92 L2106.84 1479.92 L2106.84 1483.85 L2084.9 1483.85 L2084.9 1479.92 Q2087.56 1477.16 2092.14 1472.53 Q2096.75 1467.88 2097.93 1466.54 Q2100.18 1464.01 2101.05 1462.28 Q2101.96 1460.52 2101.96 1458.83 Q2101.96 1456.07 2100.01 1454.34 Q2098.09 1452.6 2094.99 1452.6 Q2092.79 1452.6 2090.34 1453.37 Q2087.91 1454.13 2085.13 1455.68 L2085.13 1450.96 Q2087.95 1449.82 2090.41 1449.25 Q2092.86 1448.67 2094.9 1448.67 Q2100.27 1448.67 2103.46 1451.35 Q2106.66 1454.04 2106.66 1458.53 Q2106.66 1460.66 2105.85 1462.58 Q2105.06 1464.48 2102.95 1467.07 Q2102.37 1467.74 2099.27 1470.96 Q2096.17 1474.15 2090.52 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M2116.7 1449.29 L2135.06 1449.29 L2135.06 1453.23 L2120.99 1453.23 L2120.99 1461.7 Q2122 1461.35 2123.02 1461.19 Q2124.04 1461 2125.06 1461 Q2130.85 1461 2134.23 1464.18 Q2137.61 1467.35 2137.61 1472.76 Q2137.61 1478.34 2134.13 1481.44 Q2130.66 1484.52 2124.34 1484.52 Q2122.17 1484.52 2119.9 1484.15 Q2117.65 1483.78 2115.24 1483.04 L2115.24 1478.34 Q2117.33 1479.48 2119.55 1480.03 Q2121.77 1480.59 2124.25 1480.59 Q2128.25 1480.59 2130.59 1478.48 Q2132.93 1476.38 2132.93 1472.76 Q2132.93 1469.15 2130.59 1467.05 Q2128.25 1464.94 2124.25 1464.94 Q2122.37 1464.94 2120.5 1465.36 Q2118.65 1465.77 2116.7 1466.65 L2116.7 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M1292.04 1565.85 L1292.04 1581.6 L1286.15 1581.6 L1286.15 1532.62 Q1286.15 1518.1 1299.71 1518.1 Q1313.52 1518.1 1313.52 1530.36 Q1313.52 1539.08 1308.05 1542.26 Q1316.96 1545.13 1316.96 1553.63 Q1316.96 1568.71 1301.62 1568.71 Q1294.87 1568.71 1292.04 1565.85 M1292.04 1558.21 Q1295.57 1563.72 1301.84 1563.72 Q1311.01 1563.72 1311.01 1553.72 Q1311.01 1544.75 1296.24 1545.45 L1296.24 1540.03 Q1307.79 1540.03 1307.79 1529.85 Q1307.79 1522.88 1300.34 1522.88 Q1292.04 1522.88 1292.04 1532.81 L1292.04 1558.21 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip602)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  250.352,1265.74 2352.76,1265.74 
  "/>
<polyline clip-path="url(#clip602)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  250.352,951.738 2352.76,951.738 
  "/>
<polyline clip-path="url(#clip602)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  250.352,637.741 2352.76,637.741 
  "/>
<polyline clip-path="url(#clip602)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  250.352,323.743 2352.76,323.743 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  250.352,1423.18 250.352,47.2441 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  250.352,1265.74 269.25,1265.74 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  250.352,951.738 269.25,951.738 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  250.352,637.741 269.25,637.741 
  "/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  250.352,323.743 269.25,323.743 
  "/>
<path clip-path="url(#clip600)" d="M132.177 1264.38 Q135.533 1265.1 137.408 1267.37 Q139.306 1269.64 139.306 1272.97 Q139.306 1278.09 135.788 1280.89 Q132.269 1283.69 125.788 1283.69 Q123.612 1283.69 121.297 1283.25 Q119.006 1282.83 116.552 1281.97 L116.552 1277.46 Q118.496 1278.6 120.811 1279.17 Q123.126 1279.75 125.649 1279.75 Q130.047 1279.75 132.339 1278.02 Q134.654 1276.28 134.654 1272.97 Q134.654 1269.91 132.501 1268.2 Q130.371 1266.47 126.552 1266.47 L122.524 1266.47 L122.524 1262.62 L126.737 1262.62 Q130.186 1262.62 132.015 1261.26 Q133.843 1259.87 133.843 1257.28 Q133.843 1254.61 131.945 1253.2 Q130.07 1251.77 126.552 1251.77 Q124.63 1251.77 122.431 1252.18 Q120.232 1252.6 117.593 1253.48 L117.593 1249.31 Q120.255 1248.57 122.57 1248.2 Q124.908 1247.83 126.968 1247.83 Q132.292 1247.83 135.394 1250.26 Q138.496 1252.67 138.496 1256.79 Q138.496 1259.66 136.853 1261.65 Q135.209 1263.62 132.177 1264.38 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M148.172 1277.14 L153.056 1277.14 L153.056 1283.02 L148.172 1283.02 L148.172 1277.14 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M167.269 1279.08 L183.588 1279.08 L183.588 1283.02 L161.644 1283.02 L161.644 1279.08 Q164.306 1276.33 168.889 1271.7 Q173.496 1267.04 174.677 1265.7 Q176.922 1263.18 177.801 1261.44 Q178.704 1259.68 178.704 1257.99 Q178.704 1255.24 176.76 1253.5 Q174.839 1251.77 171.737 1251.77 Q169.538 1251.77 167.084 1252.53 Q164.653 1253.29 161.876 1254.85 L161.876 1250.12 Q164.7 1248.99 167.153 1248.41 Q169.607 1247.83 171.644 1247.83 Q177.014 1247.83 180.209 1250.52 Q183.403 1253.2 183.403 1257.69 Q183.403 1259.82 182.593 1261.74 Q181.806 1263.64 179.7 1266.23 Q179.121 1266.91 176.019 1270.12 Q172.917 1273.32 167.269 1279.08 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M193.45 1248.46 L211.806 1248.46 L211.806 1252.39 L197.732 1252.39 L197.732 1260.86 Q198.75 1260.52 199.769 1260.35 Q200.787 1260.17 201.806 1260.17 Q207.593 1260.17 210.973 1263.34 Q214.352 1266.51 214.352 1271.93 Q214.352 1277.51 210.88 1280.61 Q207.408 1283.69 201.088 1283.69 Q198.912 1283.69 196.644 1283.32 Q194.399 1282.95 191.991 1282.21 L191.991 1277.51 Q194.075 1278.64 196.297 1279.2 Q198.519 1279.75 200.996 1279.75 Q205 1279.75 207.338 1277.65 Q209.676 1275.54 209.676 1271.93 Q209.676 1268.32 207.338 1266.21 Q205 1264.1 200.996 1264.1 Q199.121 1264.1 197.246 1264.52 Q195.394 1264.94 193.45 1265.82 L193.45 1248.46 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M131.181 950.384 Q134.538 951.102 136.413 953.37 Q138.311 955.639 138.311 958.972 Q138.311 964.088 134.792 966.889 Q131.274 969.69 124.793 969.69 Q122.617 969.69 120.302 969.25 Q118.01 968.833 115.556 967.977 L115.556 963.463 Q117.501 964.597 119.816 965.176 Q122.13 965.755 124.654 965.755 Q129.052 965.755 131.343 964.018 Q133.658 962.282 133.658 958.972 Q133.658 955.917 131.505 954.204 Q129.376 952.468 125.556 952.468 L121.529 952.468 L121.529 948.625 L125.742 948.625 Q129.191 948.625 131.019 947.259 Q132.848 945.87 132.848 943.278 Q132.848 940.616 130.95 939.204 Q129.075 937.769 125.556 937.769 Q123.635 937.769 121.436 938.185 Q119.237 938.602 116.598 939.482 L116.598 935.315 Q119.26 934.574 121.575 934.204 Q123.913 933.833 125.973 933.833 Q131.297 933.833 134.399 936.264 Q137.501 938.671 137.501 942.792 Q137.501 945.662 135.857 947.653 Q134.214 949.62 131.181 950.384 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M147.177 963.139 L152.061 963.139 L152.061 969.018 L147.177 969.018 L147.177 963.139 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M162.292 934.458 L180.649 934.458 L180.649 938.394 L166.575 938.394 L166.575 946.866 Q167.593 946.519 168.612 946.357 Q169.63 946.171 170.649 946.171 Q176.436 946.171 179.815 949.343 Q183.195 952.514 183.195 957.931 Q183.195 963.509 179.723 966.611 Q176.251 969.69 169.931 969.69 Q167.755 969.69 165.487 969.319 Q163.241 968.949 160.834 968.208 L160.834 963.509 Q162.917 964.643 165.14 965.199 Q167.362 965.755 169.839 965.755 Q173.843 965.755 176.181 963.648 Q178.519 961.542 178.519 957.931 Q178.519 954.319 176.181 952.213 Q173.843 950.107 169.839 950.107 Q167.964 950.107 166.089 950.523 Q164.237 950.94 162.292 951.819 L162.292 934.458 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M202.408 937.537 Q198.797 937.537 196.968 941.102 Q195.163 944.644 195.163 951.773 Q195.163 958.88 196.968 962.444 Q198.797 965.986 202.408 965.986 Q206.042 965.986 207.848 962.444 Q209.676 958.88 209.676 951.773 Q209.676 944.644 207.848 941.102 Q206.042 937.537 202.408 937.537 M202.408 933.833 Q208.218 933.833 211.274 938.44 Q214.352 943.023 214.352 951.773 Q214.352 960.5 211.274 965.106 Q208.218 969.69 202.408 969.69 Q196.598 969.69 193.519 965.106 Q190.463 960.5 190.463 951.773 Q190.463 943.023 193.519 938.44 Q196.598 933.833 202.408 933.833 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M132.177 636.386 Q135.533 637.104 137.408 639.372 Q139.306 641.641 139.306 644.974 Q139.306 650.09 135.788 652.891 Q132.269 655.692 125.788 655.692 Q123.612 655.692 121.297 655.252 Q119.006 654.835 116.552 653.979 L116.552 649.465 Q118.496 650.599 120.811 651.178 Q123.126 651.757 125.649 651.757 Q130.047 651.757 132.339 650.021 Q134.654 648.284 134.654 644.974 Q134.654 641.919 132.501 640.206 Q130.371 638.47 126.552 638.47 L122.524 638.47 L122.524 634.627 L126.737 634.627 Q130.186 634.627 132.015 633.261 Q133.843 631.873 133.843 629.28 Q133.843 626.618 131.945 625.206 Q130.07 623.771 126.552 623.771 Q124.63 623.771 122.431 624.187 Q120.232 624.604 117.593 625.484 L117.593 621.317 Q120.255 620.576 122.57 620.206 Q124.908 619.836 126.968 619.836 Q132.292 619.836 135.394 622.266 Q138.496 624.673 138.496 628.794 Q138.496 631.664 136.853 633.655 Q135.209 635.622 132.177 636.386 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M148.172 649.141 L153.056 649.141 L153.056 655.021 L148.172 655.021 L148.172 649.141 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M162.061 620.461 L184.283 620.461 L184.283 622.451 L171.737 655.021 L166.852 655.021 L178.658 624.396 L162.061 624.396 L162.061 620.461 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M193.45 620.461 L211.806 620.461 L211.806 624.396 L197.732 624.396 L197.732 632.868 Q198.75 632.521 199.769 632.359 Q200.787 632.173 201.806 632.173 Q207.593 632.173 210.973 635.345 Q214.352 638.516 214.352 643.933 Q214.352 649.511 210.88 652.613 Q207.408 655.692 201.088 655.692 Q198.912 655.692 196.644 655.321 Q194.399 654.951 191.991 654.21 L191.991 649.511 Q194.075 650.646 196.297 651.201 Q198.519 651.757 200.996 651.757 Q205 651.757 207.338 649.65 Q209.676 647.544 209.676 643.933 Q209.676 640.322 207.338 638.215 Q205 636.109 200.996 636.109 Q199.121 636.109 197.246 636.525 Q195.394 636.942 193.45 637.822 L193.45 620.461 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M129.862 310.537 L118.056 328.986 L129.862 328.986 L129.862 310.537 M128.635 306.463 L134.515 306.463 L134.515 328.986 L139.445 328.986 L139.445 332.875 L134.515 332.875 L134.515 341.023 L129.862 341.023 L129.862 332.875 L114.26 332.875 L114.26 328.361 L128.635 306.463 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M147.177 335.143 L152.061 335.143 L152.061 341.023 L147.177 341.023 L147.177 335.143 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M172.246 309.541 Q168.635 309.541 166.806 313.106 Q165.001 316.648 165.001 323.777 Q165.001 330.884 166.806 334.449 Q168.635 337.99 172.246 337.99 Q175.88 337.99 177.686 334.449 Q179.514 330.884 179.514 323.777 Q179.514 316.648 177.686 313.106 Q175.88 309.541 172.246 309.541 M172.246 305.838 Q178.056 305.838 181.112 310.444 Q184.19 315.027 184.19 323.777 Q184.19 332.504 181.112 337.111 Q178.056 341.694 172.246 341.694 Q166.436 341.694 163.357 337.111 Q160.302 332.504 160.302 323.777 Q160.302 315.027 163.357 310.444 Q166.436 305.838 172.246 305.838 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M202.408 309.541 Q198.797 309.541 196.968 313.106 Q195.163 316.648 195.163 323.777 Q195.163 330.884 196.968 334.449 Q198.797 337.99 202.408 337.99 Q206.042 337.99 207.848 334.449 Q209.676 330.884 209.676 323.777 Q209.676 316.648 207.848 313.106 Q206.042 309.541 202.408 309.541 M202.408 305.838 Q208.218 305.838 211.274 310.444 Q214.352 315.027 214.352 323.777 Q214.352 332.504 211.274 337.111 Q208.218 341.694 202.408 341.694 Q196.598 341.694 193.519 337.111 Q190.463 332.504 190.463 323.777 Q190.463 315.027 193.519 310.444 Q196.598 305.838 202.408 305.838 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M47.4215 730.008 L40.0691 731.408 Q32.5257 732.841 32.5257 738.506 Q32.5257 742.771 36.0269 744.713 Q40.4192 747.164 46.212 747.164 Q53.2143 747.164 56.5563 744.776 Q59.9619 742.357 59.9619 738.506 Q59.9619 734.241 53.1825 731.95 L47.4215 730.008 M37.682 726.73 L28.3562 723.579 L28.3562 718.359 L47.6761 724.884 L54.6466 723.61 Q56.2062 723.324 57.5111 722.21 Q59.0389 720.905 59.0389 719.887 L59.0389 717.086 L64.0042 717.086 L64.0042 720.587 Q64.0042 723.579 61.3306 726.252 Q59.9938 727.557 57.1929 728.098 Q60.7258 729.562 63.4949 732.554 Q64.7999 733.955 64.7999 738.506 Q64.7999 745.986 59.9619 749.614 Q54.9649 753.338 46.212 753.338 Q36.8544 753.338 32.4621 749.296 Q27.5605 744.808 27.5605 738.506 Q27.5605 728.608 37.682 726.73 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip602)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1015.27,1384.24 1038.92,1338.39 1071.92,1276.75 1118.83,1193.45 1177.85,1095.25 1243.07,994.511 1315.23,891.594 1395.11,787.038 1483.5,681.619 1581.11,576.441 
  1688.36,473.053 1805.05,373.607 1929.63,281.079 2057.79,199.557 2179.65,134.604 2273.63,93.6468 2293.25,86.1857 2136.6,123.038 1572.86,212.036 991.275,274.237 
  309.854,326.658 
  "/>
<path clip-path="url(#clip602)" d="M2281.25 74.1857 L2281.25 98.1857 L2305.25 98.1857 L2305.25 74.1857 L2281.25 74.1857 Z" fill="#ff8247" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="0"/>
<circle clip-path="url(#clip602)" cx="2293.25" cy="86.1857" r="10" fill="#ff8247" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="0"/>
<path clip-path="url(#clip600)" d="
M1943.38 1377.32 L2282.68 1377.32 L2282.68 1273.64 L1943.38 1273.64  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip600)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1943.38,1377.32 2282.68,1377.32 2282.68,1273.64 1943.38,1273.64 1943.38,1377.32 
  "/>
<circle clip-path="url(#clip600)" cx="2036.82" cy="1325.48" r="23" fill="#ff8247" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="0"/>
<path clip-path="url(#clip600)" d="M2150.77 1317.82 L2150.77 1321.81 Q2148.97 1320.81 2147.14 1320.32 Q2145.33 1319.82 2143.48 1319.82 Q2139.34 1319.82 2137.04 1322.45 Q2134.75 1325.07 2134.75 1329.82 Q2134.75 1334.56 2137.04 1337.2 Q2139.34 1339.82 2143.48 1339.82 Q2145.33 1339.82 2147.14 1339.33 Q2148.97 1338.82 2150.77 1337.82 L2150.77 1341.76 Q2148.99 1342.59 2147.07 1343.01 Q2145.17 1343.43 2143.02 1343.43 Q2137.16 1343.43 2133.71 1339.75 Q2130.26 1336.07 2130.26 1329.82 Q2130.26 1323.47 2133.73 1319.84 Q2137.23 1316.2 2143.29 1316.2 Q2145.26 1316.2 2147.14 1316.62 Q2149.01 1317.01 2150.77 1317.82 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M2157.74 1332.52 L2157.74 1316.83 L2162 1316.83 L2162 1332.36 Q2162 1336.04 2163.43 1337.89 Q2164.87 1339.72 2167.74 1339.72 Q2171.19 1339.72 2173.18 1337.52 Q2175.19 1335.32 2175.19 1331.53 L2175.19 1316.83 L2179.45 1316.83 L2179.45 1342.76 L2175.19 1342.76 L2175.19 1338.77 Q2173.64 1341.13 2171.58 1342.29 Q2169.54 1343.43 2166.84 1343.43 Q2162.37 1343.43 2160.05 1340.65 Q2157.74 1337.87 2157.74 1332.52 M2168.46 1316.2 L2168.46 1316.2 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M2204.75 1317.59 L2204.75 1321.62 Q2202.95 1320.7 2201 1320.23 Q2199.06 1319.77 2196.97 1319.77 Q2193.8 1319.77 2192.21 1320.74 Q2190.63 1321.71 2190.63 1323.66 Q2190.63 1325.14 2191.77 1326 Q2192.9 1326.83 2196.33 1327.59 L2197.78 1327.92 Q2202.32 1328.89 2204.22 1330.67 Q2206.14 1332.43 2206.14 1335.6 Q2206.14 1339.21 2203.27 1341.32 Q2200.42 1343.43 2195.42 1343.43 Q2193.34 1343.43 2191.07 1343.01 Q2188.83 1342.62 2186.33 1341.81 L2186.33 1337.41 Q2188.69 1338.63 2190.98 1339.26 Q2193.27 1339.86 2195.52 1339.86 Q2198.53 1339.86 2200.15 1338.84 Q2201.77 1337.8 2201.77 1335.93 Q2201.77 1334.19 2200.59 1333.26 Q2199.43 1332.34 2195.47 1331.48 L2193.99 1331.14 Q2190.03 1330.3 2188.27 1328.59 Q2186.51 1326.85 2186.51 1323.84 Q2186.51 1320.19 2189.1 1318.2 Q2191.7 1316.2 2196.47 1316.2 Q2198.83 1316.2 2200.91 1316.55 Q2202.99 1316.9 2204.75 1317.59 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip600)" d="M2217.04 1338.87 L2217.04 1352.62 L2212.76 1352.62 L2212.76 1316.83 L2217.04 1316.83 L2217.04 1320.76 Q2218.39 1318.45 2220.42 1317.34 Q2222.48 1316.2 2225.33 1316.2 Q2230.05 1316.2 2232.99 1319.95 Q2235.96 1323.7 2235.96 1329.82 Q2235.96 1335.93 2232.99 1339.68 Q2230.05 1343.43 2225.33 1343.43 Q2222.48 1343.43 2220.42 1342.32 Q2218.39 1341.18 2217.04 1338.87 M2231.53 1329.82 Q2231.53 1325.12 2229.59 1322.45 Q2227.67 1319.77 2224.29 1319.77 Q2220.91 1319.77 2218.97 1322.45 Q2217.04 1325.12 2217.04 1329.82 Q2217.04 1334.51 2218.97 1337.2 Q2220.91 1339.86 2224.29 1339.86 Q2227.67 1339.86 2229.59 1337.2 Q2231.53 1334.51 2231.53 1329.82 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<h2 id="Using-GMRES-or-another-linear-solver"><a class="docs-heading-anchor" href="#Using-GMRES-or-another-linear-solver">Using GMRES or another linear solver</a><a id="Using-GMRES-or-another-linear-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Using-GMRES-or-another-linear-solver" title="Permalink"></a></h2><p>We continue the previous example but now using Matrix Free methods. The user can pass its own solver by implementing a version of <code>LinearSolver</code>. Some linear solvers have been implemented from <code>KrylovKit.jl</code> and <code>IterativeSolvers.jl</code> (see <a href="../linearsolver/#Linear-solvers-(LS)">Linear solvers (LS)</a> for more information), we can use them here. Note that we can also use preconditioners as shown below. The same functionality is present for the eigensolver.</p><pre><code class="language-julia hljs"># derivative of N
dN(x; a = 0.5, b = 0.01) = (1-b*x^2+2*a*x)/(1+b*x^2)^2

# Matrix Free version of the differential of F_chan
# Very easy to write since we have F_chan.
# We could use Automatic Differentiation as well
function dF_chan(x, dx, p)
	@unpack α, β = p
	out = similar(x)
	n = length(x)
	out[1] = dx[1]
	out[n] = dx[n]
	for i=2:n-1
		out[i] = (dx[i-1] - 2 * dx[i] + dx[i+1]) * (n-1)^2 + α * dN(x[i], b = β) * dx[i]
	end
	return out
end

# we create a new linear solver
ls = GMRESKrylovKit(dim = 100)

# and pass it to the newton parameters
optnewton_mf = NewtonPar(verbose = true, linsolver = ls)

# we can then call the newton solver
out_mf, = @time newton(
	F_chan,
	# we pass the differential a x,
	# which is a linear operator in dx
	(x, p) -&gt; (dx -&gt; dF_chan(x, dx, p)),
	sol, par,
	optnewton_mf)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
┌─────────────────────────────────────────────────────┐
│ Newton Iterations      f(x)      Linear Iterations  │
├─────────────┬──────────────────────┬────────────────┤
│       0     │       2.3440e+01     │        0       │
│       1     │       1.3774e+00     │       68       │
│       2     │       1.6267e-02     │       98       │
│       3     │       2.4336e-06     │       74       │
│       4     │       5.6275e-12     │       63       │
└─────────────┴──────────────────────┴────────────────┘
 12.102293 seconds (30.32 M allocations: 1.848 GiB, 6.13% gc time)</code></pre><p>We can improve this computation, <em>i.e.</em> reduce the number of <code>Linear-Iterations</code>, by using a preconditioner</p><pre><code class="language-julia hljs">using SparseArrays

# define preconditioner which is basically Δ
P = spdiagm(0 =&gt; -2 * (n-1)^2 * ones(n), -1 =&gt; (n-1)^2 * ones(n-1), 1 =&gt; (n-1)^2 * ones(n-1))
P[1,1:2] .= [1, 0.];P[end,end-1:end] .= [0, 1.]

# define gmres solver with left preconditioner
ls = GMRESIterativeSolvers(reltol = 1e-4, N = length(sol), restart = 10, maxiter = 10, Pl = lu(P))
	optnewton_mf = NewtonPar(verbose = true, linsolver = ls)
	out_mf, = @time newton(F_chan,
	(x, p) -&gt; (dx -&gt; dF_chan(x, dx, p)),
	sol, par, optnewton_mf)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
┌─────────────────────────────────────────────────────┐
│ Newton Iterations      f(x)      Linear Iterations  │
├─────────────┬──────────────────────┬────────────────┤
│       0     │       2.3440e+01     │        0       │
│       1     │       1.3777e+00     │        3       │
│       2     │       1.6266e-02     │        3       │
│       3     │       2.3699e-05     │        2       │
│       4     │       4.8929e-09     │        3       │
│       5     │       5.6333e-12     │        4       │
└─────────────┴──────────────────────┴────────────────┘
  4.313275 seconds (10.75 M allocations: 627.646 MiB, 6.11% gc time, 99.97% compilation time)</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Friday 27 August 2021 12:15">Friday 27 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
